---
permalink: remediation-of-cve-2021-34527-windows-print-spooler-remote-code-execution-vulnerability/
audit_date: '2021-07-08'
title: Remediation of CVE-2021-34527 Windows Print Spooler Remote Code Execution Vulnerability
type: article
created_date: '2021-07-08'
created_by: Brent Frye
last_modified_date: '2021-07-08'
last_modified_by: Stephanie Fillmon
product: General
product_url: general
---

A remote code execution vulnerability exists when the Windows Print Spooler
service improperly performs privileged file operations. An attacker who
successfully exploited this vulnerability could run arbitrary code with
SYSTEM privileges. An attacker could then install programs; view, change, or
delete data; or create new accounts with full user rights.

For more information, see Microsoft's complete guidance for
[CVE-2021-34527](https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-34527).

### Rackspace recommended remediation

For customers that use Rackspace Managed Patching, the required update will
be available with the release of July 2021 patches.

#### Out-of-band remediation

For customers that want to remediate this prior to July 2021's patching window,
use the following steps:

Install the applicable out-of-band update in [CVE-2021-34527](https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-34527). These updates require a reboot.

1. Open the Registry Editor for the server on which you want to install the
   update by clicking **Start Menu > Run**. Type "regedit" and then click
   **OK**.
2. Navigate to `HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows NT\Printers\PointAndPrint`
   and look for the following registry keys:

       NoWarningNoElevationOnInstall
       NoWarningNoElevationOnUpdate

   If the registry keys do not exist or are set to zero, Point and
   Print are disabled. If the values are set to one, Point and Print are
   enabled and setting the values to zero disables this feature. Ensure that
   disabling this feature won't affect necessary business operations on the
   server.

After patching, Microsoft also recommends that you complete the steps in
[KB5005010: Restricting installation of new printer drivers after applying the July 6, 2021 updates](https://support.microsoft.com/en-us/topic/kb5005010-restricting-installation-of-new-printer-drivers-after-applying-the-july-6-2021-updates-31b91c02-05bc-4ada-a7ea-183b129578a7).

### Workarounds

In the event patches cannot be installed at this time, there are workarounds
available to protect servers until the patches can be installed.

**Option 1**

Disable the Print Spooler service on servers which are not serving in any
printing capacity by using the following commands:

    Stop-Service -Name Spooler -Force

    Set-Service -Name Spooler -StartupType Disabled

**Option 2**

Disable inbound remote printing through Group Policy by using the following
steps:

1. In Group Policy Editor, navigate to
   **Computer Configuration > Administrative Templates > Printers**.

2. Disable the **Allow Print Spooler to accept client connections" policy to
   block remote attacks.

3. Restart the Print Spooler service.

If you need more information or further assistance regarding this
vulnerability, open a Support ticket in the customer portal or contact your
Rackspace Support team.
